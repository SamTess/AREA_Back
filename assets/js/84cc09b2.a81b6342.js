"use strict";(globalThis.webpackChunkdocusaurus=globalThis.webpackChunkdocusaurus||[]).push([[8432],{8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var r=i(6540);const s={},t=r.createContext(s);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(t.Provider,{value:n},e.children)}},8755:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"technical/webhook-system","title":"Webhook System - Technical Documentation","description":"Table of Contents","source":"@site/docs/technical/09-webhook-system.md","sourceDirName":"technical","slug":"/technical/webhook-system","permalink":"/docs/technical/webhook-system","draft":false,"unlisted":false,"editUrl":"https://github.com/SamTess/AREA_Back/tree/main/docusaurus/docs/technical/09-webhook-system.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Redis Implementation and Security - Technical Documentation","permalink":"/docs/technical/redis-implementation"},"next":{"title":"Service Providers","permalink":"/docs/category/service-providers"}}');var s=i(4848),t=i(8453);const a={},o="Webhook System - Technical Documentation",c={},l=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:3},{value:"Architecture",id:"architecture",level:2},{value:"Component Diagram",id:"component-diagram",level:3},{value:"Request Flow",id:"request-flow",level:3},{value:"Core Components",id:"core-components",level:2},{value:"1. WebhookController",id:"1-webhookcontroller",level:3},{value:"Endpoints",id:"endpoints",level:4},{value:"Parameters",id:"parameters",level:4},{value:"Example Request",id:"example-request",level:4},{value:"Response Format",id:"response-format",level:4},{value:"2. WebhookSignatureValidator",id:"2-webhooksignaturevalidator",level:3},{value:"Supported Algorithms",id:"supported-algorithms",level:4},{value:"GitHub Validation",id:"github-validation",level:4},{value:"Slack Validation",id:"slack-validation",level:4},{value:"Discord Validation",id:"discord-validation",level:4},{value:"3. WebhookSecretService",id:"3-webhooksecretservice",level:3},{value:"Configuration",id:"configuration",level:4},{value:"Secret Retrieval",id:"secret-retrieval",level:4},{value:"4. WebhookDeduplicationService",id:"4-webhookdeduplicationservice",level:3},{value:"Implementation",id:"implementation",level:4},{value:"Redis Key Format",id:"redis-key-format",level:4},{value:"TTL Strategy",id:"ttl-strategy",level:4},{value:"5. WebhookEventProcessingService",id:"5-webhookeventprocessingservice",level:3},{value:"Main Methods",id:"main-methods",level:4},{value:"Action Matching",id:"action-matching",level:4},{value:"Execution Creation",id:"execution-creation",level:4},{value:"6. PayloadMappingService",id:"6-payloadmappingservice",level:3},{value:"Mapping Strategy",id:"mapping-strategy",level:4},{value:"GitHub Mapping Examples",id:"github-mapping-examples",level:4},{value:"Property Extraction",id:"property-extraction",level:4},{value:"Webhook Flow",id:"webhook-flow",level:2},{value:"Complete Flow Diagram",id:"complete-flow-diagram",level:3},{value:"Example Flow: GitHub Issue Webhook",id:"example-flow-github-issue-webhook",level:3},{value:"Service Integration",id:"service-integration",level:2},{value:"GitHub",id:"github",level:3},{value:"Slack",id:"slack",level:3},{value:"Discord",id:"discord",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Error Response Format",id:"error-response-format",level:3},{value:"Common Errors",id:"common-errors",level:3},{value:"Retry Strategy",id:"retry-strategy",level:3},{value:"Security",id:"security",level:2},{value:"Best Practices",id:"best-practices",level:3},{value:"Secret Management",id:"secret-management",level:3},{value:"Monitoring",id:"monitoring",level:2},{value:"Prometheus Metrics",id:"prometheus-metrics",level:3},{value:"Key Metrics",id:"key-metrics",level:3},{value:"Grafana Dashboard",id:"grafana-dashboard",level:3},{value:"Testing",id:"testing",level:2},{value:"Unit Tests",id:"unit-tests",level:3},{value:"Integration Tests",id:"integration-tests",level:3},{value:"Mock Webhook Testing",id:"mock-webhook-testing",level:3},{value:"Resources",id:"resources",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"webhook-system---technical-documentation",children:"Webhook System - Technical Documentation"})}),"\n",(0,s.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#overview",children:"Overview"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#architecture",children:"Architecture"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#core-components",children:"Core Components"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#webhook-flow",children:"Webhook Flow"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#signature-validation",children:"Signature Validation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#deduplication",children:"Event Deduplication"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#payload-mapping",children:"Payload Mapping"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#service-integration",children:"Service Integration"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#error-handling",children:"Error Handling"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#security",children:"Security"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#monitoring",children:"Monitoring"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#testing",children:"Testing"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"The Webhook System provides a robust infrastructure for receiving, validating, and processing real-time events from external services (GitHub, Slack, Discord, etc.). It ensures secure event delivery, prevents duplicate processing, and orchestrates automated workflow executions."}),"\n",(0,s.jsx)(n.h3,{id:"key-features",children:"Key Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Multi-Service Support"}),": Handle webhooks from GitHub, Slack, Discord, and more"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Signature Validation"}),": Cryptographic verification of webhook authenticity"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Event Deduplication"}),": Prevent duplicate event processing using Redis"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Payload Mapping"}),": Transform webhook payloads to internal action parameters"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Automatic Orchestration"}),": Trigger workflows based on incoming events"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Monitoring"}),": Prometheus metrics for webhook performance and reliability"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,s.jsx)(n.h3,{id:"component-diagram",children:"Component Diagram"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"External Service (GitHub/Discord/Slack)\n          \u2193\n    [Webhook Endpoint]\n          \u2193\n[Signature Validator] \u2190 [Webhook Secret Service]\n          \u2193\n[Deduplication Service] \u2190 [Redis Cache]\n          \u2193\n[Event Processing Service]\n          \u2193\n    [Payload Mapper]\n          \u2193\n  [Execution Service] \u2192 [Worker Queue]\n"})}),"\n",(0,s.jsx)(n.h3,{id:"request-flow",children:"Request Flow"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"External service sends webhook POST request"}),"\n",(0,s.jsx)(n.li,{children:"Controller receives and logs request"}),"\n",(0,s.jsx)(n.li,{children:"Signature validation against stored secret"}),"\n",(0,s.jsx)(n.li,{children:"Event ID extraction and deduplication check"}),"\n",(0,s.jsx)(n.li,{children:"Match webhook to action instances"}),"\n",(0,s.jsx)(n.li,{children:"Map payload to action parameters"}),"\n",(0,s.jsx)(n.li,{children:"Create and queue execution"}),"\n",(0,s.jsx)(n.li,{children:"Return success response"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"core-components",children:"Core Components"}),"\n",(0,s.jsx)(n.h3,{id:"1-webhookcontroller",children:"1. WebhookController"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"src/main/java/area/server/AREA_Back/controller/WebhookController.java"})]}),"\n",(0,s.jsx)(n.p,{children:"Main entry point for all webhook requests."}),"\n",(0,s.jsx)(n.h4,{id:"endpoints",children:"Endpoints"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"POST /api/hooks/{service}/{action}\nPOST /api/hooks/{service}/{action}?userId={uuid}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"service"}),": Service identifier (github, slack, discord)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"action"}),": Event type (issues, pull_request, message, etc.)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"userId"}),": Optional user scoping"]}),"\n",(0,s.jsx)(n.li,{children:"Request Body: JSON payload from external service"}),"\n",(0,s.jsx)(n.li,{children:"Headers: Service-specific signature headers"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"example-request",children:"Example Request"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-http",children:'POST /api/hooks/github/issues HTTP/1.1\nHost: api.area.com\nContent-Type: application/json\nX-GitHub-Event: issues\nX-Hub-Signature-256: sha256=abc123...\nX-GitHub-Delivery: 12345-67890\n\n{\n  "action": "opened",\n  "issue": {\n    "number": 42,\n    "title": "Bug report",\n    "body": "Issue description",\n    "user": {\n      "login": "username"\n    }\n  },\n  "repository": {\n    "full_name": "owner/repo"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"response-format",children:"Response Format"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Success (200 OK)"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "status": "processed",\n  "message": "Webhook processed successfully",\n  "eventId": "12345-67890",\n  "service": "github",\n  "action": "issues",\n  "executionCount": 2,\n  "executionIds": [\n    "550e8400-e29b-41d4-a716-446655440000",\n    "550e8400-e29b-41d4-a716-446655440001"\n  ],\n  "processingTimeMs": 145,\n  "timestamp": "2024-01-15T10:30:00"\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Duplicate (200 OK)"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "status": "duplicate",\n  "message": "Event already processed",\n  "eventId": "12345-67890",\n  "service": "github",\n  "action": "issues",\n  "timestamp": "2024-01-15T10:30:00"\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Invalid Signature (401 Unauthorized)"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "error": "Invalid signature",\n  "service": "github",\n  "action": "issues",\n  "timestamp": "2024-01-15T10:30:00"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"2-webhooksignaturevalidator",children:"2. WebhookSignatureValidator"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"src/main/java/area/server/AREA_Back/service/Webhook/WebhookSignatureValidator.java"})]}),"\n",(0,s.jsx)(n.p,{children:"Validates webhook signatures using service-specific algorithms."}),"\n",(0,s.jsx)(n.h4,{id:"supported-algorithms",children:"Supported Algorithms"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Service"}),(0,s.jsx)(n.th,{children:"Algorithm"}),(0,s.jsx)(n.th,{children:"Header"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"GitHub"}),(0,s.jsx)(n.td,{children:"HMAC-SHA256"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"X-Hub-Signature-256"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Slack"}),(0,s.jsx)(n.td,{children:"HMAC-SHA256"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"X-Slack-Signature"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Discord"}),(0,s.jsx)(n.td,{children:"Ed25519"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"X-Signature-Ed25519"})})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"github-validation",children:"GitHub Validation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public boolean validateGitHubSignature(String signature, String payload, String secret) {\n    try {\n        Mac hmac = Mac.getInstance("HmacSHA256");\n        SecretKeySpec secretKey = new SecretKeySpec(secret.getBytes(), "HmacSHA256");\n        hmac.init(secretKey);\n        \n        byte[] hash = hmac.doFinal(payload.getBytes());\n        String computed = "sha256=" + Hex.encodeHexString(hash);\n        \n        return MessageDigest.isEqual(\n            signature.getBytes(),\n            computed.getBytes()\n        );\n    } catch (Exception e) {\n        log.error("GitHub signature validation failed", e);\n        return false;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"slack-validation",children:"Slack Validation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public boolean validateSlackSignature(String signature, String timestamp, \n                                      String body, String secret) {\n    // Check timestamp freshness (max 5 minutes)\n    long requestTime = Long.parseLong(timestamp);\n    long currentTime = System.currentTimeMillis() / 1000;\n    if (Math.abs(currentTime - requestTime) > 300) {\n        return false;\n    }\n    \n    // Compute signature\n    String baseString = "v0:" + timestamp + ":" + body;\n    String computed = "v0=" + hmacSha256(baseString, secret);\n    \n    return MessageDigest.isEqual(\n        signature.getBytes(),\n        computed.getBytes()\n    );\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"discord-validation",children:"Discord Validation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public boolean validateDiscordSignature(String signature, String timestamp,\n                                       String body, String publicKey) {\n    try {\n        byte[] message = (timestamp + body).getBytes();\n        byte[] signatureBytes = Hex.decodeHex(signature);\n        byte[] publicKeyBytes = Hex.decodeHex(publicKey);\n        \n        return Ed25519.verify(signatureBytes, message, publicKeyBytes);\n    } catch (Exception e) {\n        log.error("Discord signature validation failed", e);\n        return false;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"3-webhooksecretservice",children:"3. WebhookSecretService"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"src/main/java/area/server/AREA_Back/service/Webhook/WebhookSecretService.java"})]}),"\n",(0,s.jsx)(n.p,{children:"Manages webhook secrets for signature validation."}),"\n",(0,s.jsx)(n.h4,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Secrets are loaded from environment variables:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-properties",children:"app.webhook.github.secret=${GITHUB_WEBHOOK_SECRET}\napp.webhook.slack.secret=${SLACK_WEBHOOK_SECRET}\napp.webhook.discord.secret=${DISCORD_WEBHOOK_PUBLIC_KEY}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"secret-retrieval",children:"Secret Retrieval"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Service\n@RequiredArgsConstructor\npublic class WebhookSecretService {\n    \n    @Value("${app.webhook.github.secret:#{null}}")\n    private String githubWebhookSecret;\n    \n    @Value("${app.webhook.slack.secret:#{null}}")\n    private String slackWebhookSecret;\n    \n    @Value("${app.webhook.discord.secret:#{null}}")\n    private String discordWebhookSecret;\n    \n    private final Map<String, String> secretCache = new HashMap<>();\n    \n    public String getServiceSecret(String service) {\n        if (secretCache.containsKey(service.toLowerCase())) {\n            return secretCache.get(service.toLowerCase());\n        }\n        \n        String secret = switch (service.toLowerCase()) {\n            case "github" -> githubWebhookSecret;\n            case "slack" -> slackWebhookSecret;\n            case "discord" -> discordWebhookSecret;\n            default -> null;\n        };\n        \n        if (secret != null) {\n            secretCache.put(service.toLowerCase(), secret);\n        }\n        \n        return secret;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"4-webhookdeduplicationservice",children:"4. WebhookDeduplicationService"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"src/main/java/area/server/AREA_Back/service/Webhook/WebhookDeduplicationService.java"})]}),"\n",(0,s.jsx)(n.p,{children:"Prevents duplicate webhook processing using Redis."}),"\n",(0,s.jsx)(n.h4,{id:"implementation",children:"Implementation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Service\n@RequiredArgsConstructor\npublic class WebhookDeduplicationService {\n    \n    private final RedisTemplate<String, String> redisTemplate;\n    private static final Duration DEDUP_TTL = Duration.ofHours(24);\n    \n    public boolean checkAndMark(String eventId, String service) {\n        if (eventId == null || service == null) {\n            return false;\n        }\n        \n        String key = buildKey(service, eventId);\n        \n        // Try to set key with NX (only if not exists)\n        Boolean wasSet = redisTemplate.opsForValue()\n            .setIfAbsent(key, "processed", DEDUP_TTL);\n        \n        // If wasSet is false, key already existed (duplicate)\n        return !Boolean.TRUE.equals(wasSet);\n    }\n    \n    public boolean isDuplicate(String service, String eventId) {\n        String key = buildKey(service, eventId);\n        return Boolean.TRUE.equals(redisTemplate.hasKey(key));\n    }\n    \n    private String buildKey(String service, String eventId) {\n        return String.format("webhook:dedup:%s:%s", service, eventId);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"redis-key-format",children:"Redis Key Format"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"webhook:dedup:{service}:{eventId}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"webhook:dedup:github:12345-67890-abcdef"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"webhook:dedup:slack:1234567890.123456"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"webhook:dedup:discord:987654321098765432"})}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"ttl-strategy",children:"TTL Strategy"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Default TTL: 24 hours"}),"\n",(0,s.jsx)(n.li,{children:"Prevents reprocessing of late/retry deliveries"}),"\n",(0,s.jsx)(n.li,{children:"Automatic cleanup via Redis expiration"}),"\n",(0,s.jsx)(n.li,{children:"Memory-efficient with automatic purging"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"5-webhookeventprocessingservice",children:"5. WebhookEventProcessingService"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"src/main/java/area/server/AREA_Back/service/Webhook/WebhookEventProcessingService.java"})]}),"\n",(0,s.jsx)(n.p,{children:"Processes validated webhook events and triggers workflow executions."}),"\n",(0,s.jsx)(n.h4,{id:"main-methods",children:"Main Methods"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@Service\n@RequiredArgsConstructor\npublic class WebhookEventProcessingService {\n    \n    /**\n     * Process webhook for specific user\n     */\n    public List<Execution> processWebhookEventForUser(\n        String service,\n        String action,\n        Map<String, Object> payload,\n        UUID userId\n    ) {\n        List<ActionInstance> matchingInstances = \n            findMatchingActionInstances(service, action, userId);\n        \n        return matchingInstances.stream()\n            .map(instance -> createExecutionForWebhook(instance, payload))\n            .filter(Objects::nonNull)\n            .toList();\n    }\n    \n    /**\n     * Process webhook globally (all users)\n     */\n    public List<Execution> processWebhookEventGlobally(\n        String service,\n        String action,\n        Map<String, Object> payload\n    ) {\n        return processWebhookEvent(service, action, payload, null);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"action-matching",children:"Action Matching"}),"\n",(0,s.jsx)(n.p,{children:"The service matches incoming webhooks to action instances:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'private boolean matchesActionType(ActionInstance instance, String action) {\n    String actionKey = instance.getActionDefinition().getKey();\n    String serviceKey = instance.getActionDefinition().getService().getKey();\n    \n    // Exact match\n    if (actionKey.equals(action)) {\n        return true;\n    }\n    \n    // Service-specific matching\n    return switch (serviceKey) {\n        case "github" -> matchesGitHubAction(actionKey, action);\n        case "slack" -> matchesSlackAction(actionKey, action);\n        case "discord" -> matchesDiscordAction(actionKey, action);\n        default -> actionKey.contains(action) || action.contains(actionKey);\n    };\n}\n\nprivate boolean matchesGitHubAction(String actionKey, String webhookAction) {\n    return switch (webhookAction.toLowerCase()) {\n        case "issues" -> actionKey.equals("new_issue") || \n                        actionKey.equals("issue_updated");\n        case "pull_request" -> actionKey.equals("new_pull_request") || \n                              actionKey.equals("pr_updated");\n        case "push" -> actionKey.equals("push_to_branch") || \n                      actionKey.equals("commit_pushed");\n        case "release" -> actionKey.equals("new_release");\n        case "star" -> actionKey.equals("repository_starred");\n        default -> false;\n    };\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"execution-creation",children:"Execution Creation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'private Execution createExecutionForWebhook(\n    ActionInstance instance,\n    Map<String, Object> payload\n) {\n    try {\n        // Map webhook payload to action parameters\n        Map<String, Object> mappedPayload = payloadMappingService\n            .mapWebhookPayload(\n                instance.getActionDefinition().getService().getKey(),\n                instance.getActionDefinition().getKey(),\n                payload\n            );\n        \n        // Create execution\n        return executionService.createExecution(\n            instance.getActionLink().getArea(),\n            instance.getActionLink(),\n            mappedPayload,\n            "Triggered by webhook event"\n        );\n    } catch (Exception e) {\n        log.error("Failed to create execution for webhook", e);\n        return null;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"6-payloadmappingservice",children:"6. PayloadMappingService"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"src/main/java/area/server/AREA_Back/service/Webhook/PayloadMappingService.java"})]}),"\n",(0,s.jsx)(n.p,{children:"Transforms webhook payloads to internal action parameter format."}),"\n",(0,s.jsx)(n.h4,{id:"mapping-strategy",children:"Mapping Strategy"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Service\npublic class PayloadMappingService {\n    \n    public Map<String, Object> mapWebhookPayload(\n        String service,\n        String actionKey,\n        Map<String, Object> webhookPayload\n    ) {\n        return switch (service.toLowerCase()) {\n            case "github" -> mapGitHubPayload(actionKey, webhookPayload);\n            case "slack" -> mapSlackPayload(actionKey, webhookPayload);\n            case "discord" -> mapDiscordPayload(actionKey, webhookPayload);\n            default -> webhookPayload;\n        };\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"github-mapping-examples",children:"GitHub Mapping Examples"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'private Map<String, Object> mapGitHubPayload(\n    String actionKey,\n    Map<String, Object> payload\n) {\n    return switch (actionKey) {\n        case "new_issue" -> Map.of(\n            "issue_number", getPropertyValue(payload, "issue.number"),\n            "title", getPropertyValue(payload, "issue.title"),\n            "body", getPropertyValue(payload, "issue.body"),\n            "state", getPropertyValue(payload, "issue.state"),\n            "user", getPropertyValue(payload, "issue.user.login"),\n            "repository", getPropertyValue(payload, "repository.full_name"),\n            "url", getPropertyValue(payload, "issue.html_url"),\n            "created_at", getPropertyValue(payload, "issue.created_at")\n        );\n        \n        case "new_pull_request" -> Map.of(\n            "pr_number", getPropertyValue(payload, "pull_request.number"),\n            "title", getPropertyValue(payload, "pull_request.title"),\n            "body", getPropertyValue(payload, "pull_request.body"),\n            "state", getPropertyValue(payload, "pull_request.state"),\n            "user", getPropertyValue(payload, "pull_request.user.login"),\n            "repository", getPropertyValue(payload, "repository.full_name"),\n            "url", getPropertyValue(payload, "pull_request.html_url"),\n            "head", getPropertyValue(payload, "pull_request.head.ref"),\n            "base", getPropertyValue(payload, "pull_request.base.ref")\n        );\n        \n        default -> payload;\n    };\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"property-extraction",children:"Property Extraction"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'private Object getPropertyValue(Map<String, Object> payload, String path) {\n    String[] parts = path.split("\\\\.");\n    Object current = payload;\n    \n    for (String part : parts) {\n        if (current instanceof Map) {\n            current = ((Map<?, ?>) current).get(part);\n        } else {\n            return null;\n        }\n    }\n    \n    return current;\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"webhook-flow",children:"Webhook Flow"}),"\n",(0,s.jsx)(n.h3,{id:"complete-flow-diagram",children:"Complete Flow Diagram"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"1. External Service\n   \u2193 POST webhook\n2. WebhookController.handleWebhook()\n   \u2193\n3. Extract Event ID\n   \u2193\n4. WebhookSignatureValidator.validate()\n   \u251c\u2500 Valid \u2192 Continue\n   \u2514\u2500 Invalid \u2192 Return 401\n   \u2193\n5. WebhookDeduplicationService.checkAndMark()\n   \u251c\u2500 New \u2192 Continue\n   \u2514\u2500 Duplicate \u2192 Return 200 (duplicate status)\n   \u2193\n6. WebhookEventProcessingService.processWebhook()\n   \u2193\n7. Find Matching Action Instances\n   \u251c\u2500 Filter by service\n   \u251c\u2500 Filter by action type\n   \u2514\u2500 Filter by activation mode (WEBHOOK)\n   \u2193\n8. For each matching instance:\n   \u251c\u2500 PayloadMappingService.mapPayload()\n   \u251c\u2500 ExecutionService.createExecution()\n   \u2514\u2500 Queue execution for worker\n   \u2193\n9. Return Success Response\n   \u2514\u2500 Include execution IDs and metrics\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-flow-github-issue-webhook",children:"Example Flow: GitHub Issue Webhook"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'GitHub \u2192 POST /api/hooks/github/issues\n       Headers:\n         X-GitHub-Event: issues\n         X-Hub-Signature-256: sha256=...\n         X-GitHub-Delivery: abc-123\n       Body:\n         {"action": "opened", "issue": {...}}\n         \nController \u2192 Extract eventId: "abc-123"\n          \u2192 Validate signature \u2713\n          \u2192 Check deduplication \u2713\n          \u2192 Find matching instances:\n              - User A: "new_issue" action\n              - User B: "new_issue" action\n              \nProcessing \u2192 Map payload:\n             {\n               "issue_number": 42,\n               "title": "Bug report",\n               "repository": "owner/repo",\n               ...\n             }\n          \u2192 Create executions:\n              - Execution 1 (User A)\n              - Execution 2 (User B)\n              \nResponse \u2190 200 OK\n          {\n            "status": "processed",\n            "executionCount": 2,\n            "executionIds": [...]\n          }\n'})}),"\n",(0,s.jsx)(n.h2,{id:"service-integration",children:"Service Integration"}),"\n",(0,s.jsx)(n.h3,{id:"github",children:"GitHub"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Webhook Setup"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Go to repository Settings \u2192 Webhooks"}),"\n",(0,s.jsxs)(n.li,{children:["Add webhook URL: ",(0,s.jsx)(n.code,{children:"https://api.area.com/api/hooks/github/issues"})]}),"\n",(0,s.jsx)(n.li,{children:"Select events: Issues, Pull Requests, Push, etc."}),"\n",(0,s.jsxs)(n.li,{children:["Set secret from ",(0,s.jsx)(n.code,{children:"GITHUB_WEBHOOK_SECRET"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Supported Events"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"issues"}),": Issue created, edited, closed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"pull_request"}),": PR opened, closed, merged"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"push"}),": Code pushed to repository"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"release"}),": Release published"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"star"}),": Repository starred"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"fork"}),": Repository forked"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"slack",children:"Slack"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Webhook Setup"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create Slack App"}),"\n",(0,s.jsx)(n.li,{children:"Enable Event Subscriptions"}),"\n",(0,s.jsxs)(n.li,{children:["Set Request URL: ",(0,s.jsx)(n.code,{children:"https://api.area.com/api/hooks/slack/message"})]}),"\n",(0,s.jsxs)(n.li,{children:["Subscribe to events: ",(0,s.jsx)(n.code,{children:"message.channels"}),", ",(0,s.jsx)(n.code,{children:"reaction_added"}),", etc."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Supported Events"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"message"}),": New message posted"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"reaction_added"}),": Reaction added to message"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"channel_created"}),": Channel created"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"member_joined_channel"}),": User joined channel"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"discord",children:"Discord"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Webhook Setup"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create Discord Application"}),"\n",(0,s.jsx)(n.li,{children:"Add webhook URL in Webhooks section"}),"\n",(0,s.jsx)(n.li,{children:"Set public key for Ed25519 validation"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Supported Events"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"MESSAGE_CREATE"}),": New message"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"MESSAGE_DELETE"}),": Message deleted"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"GUILD_MEMBER_ADD"}),": Member joined"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"MESSAGE_REACTION_ADD"}),": Reaction added"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsx)(n.h3,{id:"error-response-format",children:"Error Response Format"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@ExceptionHandler(WebhookProcessingException.class)\npublic ResponseEntity<Map<String, Object>> handleWebhookError(\n    WebhookProcessingException e\n) {\n    return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(Map.of(\n        "error", "Webhook processing failed",\n        "message", e.getMessage(),\n        "service", e.getService(),\n        "action", e.getAction(),\n        "timestamp", LocalDateTime.now().toString()\n    ));\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"common-errors",children:"Common Errors"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Error"}),(0,s.jsx)(n.th,{children:"HTTP Code"}),(0,s.jsx)(n.th,{children:"Cause"}),(0,s.jsx)(n.th,{children:"Solution"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Invalid Signature"}),(0,s.jsx)(n.td,{children:"401"}),(0,s.jsx)(n.td,{children:"Wrong secret or algorithm"}),(0,s.jsx)(n.td,{children:"Verify webhook secret configuration"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Missing Headers"}),(0,s.jsx)(n.td,{children:"400"}),(0,s.jsx)(n.td,{children:"Required headers missing"}),(0,s.jsx)(n.td,{children:"Check service webhook configuration"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Payload Parse Error"}),(0,s.jsx)(n.td,{children:"400"}),(0,s.jsx)(n.td,{children:"Invalid JSON"}),(0,s.jsx)(n.td,{children:"Verify webhook payload format"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"No Matching Actions"}),(0,s.jsx)(n.td,{children:"200"}),(0,s.jsx)(n.td,{children:"No configured workflows"}),(0,s.jsx)(n.td,{children:"Create AREA with webhook trigger"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Execution Failed"}),(0,s.jsx)(n.td,{children:"500"}),(0,s.jsx)(n.td,{children:"Internal error"}),(0,s.jsx)(n.td,{children:"Check logs and worker status"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"retry-strategy",children:"Retry Strategy"}),"\n",(0,s.jsx)(n.p,{children:"Most services implement automatic retry with exponential backoff:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Attempt 1: Immediate\nAttempt 2: After 1 minute\nAttempt 3: After 5 minutes\nAttempt 4: After 30 minutes\nAttempt 5: After 2 hours\n"})}),"\n",(0,s.jsx)(n.p,{children:"Deduplication prevents multiple executions from retries."}),"\n",(0,s.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,s.jsx)(n.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Always Validate Signatures"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Never process unsigned webhooks"}),"\n",(0,s.jsx)(n.li,{children:"Use constant-time comparison"}),"\n",(0,s.jsx)(n.li,{children:"Rotate secrets regularly"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Implement Rate Limiting"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@RateLimiter(name = "webhook", fallbackMethod = "webhookRateLimitFallback")\npublic ResponseEntity<?> handleWebhook(...) {\n    // Process webhook\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Use HTTPS Only"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Reject HTTP webhook requests"}),"\n",(0,s.jsx)(n.li,{children:"Enforce TLS 1.2+"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Validate Timestamps"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Reject old requests (> 5 minutes)"}),"\n",(0,s.jsx)(n.li,{children:"Prevent replay attacks"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Log Security Events"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Invalid signatures"}),"\n",(0,s.jsx)(n.li,{children:"Suspicious patterns"}),"\n",(0,s.jsx)(n.li,{children:"Rate limit violations"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"secret-management",children:"Secret Management"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Environment variables\nexport GITHUB_WEBHOOK_SECRET="your-github-secret"\nexport SLACK_WEBHOOK_SECRET="your-slack-secret"\nexport DISCORD_WEBHOOK_PUBLIC_KEY="your-discord-public-key"\n\n# Docker Compose\nservices:\n  backend:\n    environment:\n      - GITHUB_WEBHOOK_SECRET=${GITHUB_WEBHOOK_SECRET}\n      - SLACK_WEBHOOK_SECRET=${SLACK_WEBHOOK_SECRET}\n      - DISCORD_WEBHOOK_PUBLIC_KEY=${DISCORD_WEBHOOK_PUBLIC_KEY}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"monitoring",children:"Monitoring"}),"\n",(0,s.jsx)(n.h3,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// Webhook received counter\nCounter.builder("webhook_received_total")\n    .tag("service", service)\n    .tag("action", action)\n    .description("Total webhooks received")\n    .register(meterRegistry);\n\n// Webhook processing time\nTimer.builder("webhook_processing_duration")\n    .tag("service", service)\n    .description("Webhook processing duration")\n    .register(meterRegistry);\n\n// Signature validation failures\nCounter.builder("webhook_signature_validation_failures_total")\n    .tag("service", service)\n    .description("Signature validation failures")\n    .register(meterRegistry);\n\n// Duplicate webhooks\nCounter.builder("webhook_duplicates_total")\n    .tag("service", service)\n    .description("Duplicate webhook events")\n    .register(meterRegistry);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"key-metrics",children:"Key Metrics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"webhook_received_total{service, action}"}),": Total webhooks by service"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"webhook_processing_duration{service}"}),": Processing time distribution"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"webhook_signature_validation_failures_total{service}"}),": Validation failures"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"webhook_duplicates_total{service}"}),": Duplicate event count"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"webhook_executions_created_total{service}"}),": Executions triggered"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"grafana-dashboard",children:"Grafana Dashboard"}),"\n",(0,s.jsx)(n.p,{children:"Create dashboard with panels for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Webhook request rate by service"}),"\n",(0,s.jsx)(n.li,{children:"Processing time p50, p95, p99"}),"\n",(0,s.jsx)(n.li,{children:"Error rate and types"}),"\n",(0,s.jsx)(n.li,{children:"Deduplication effectiveness"}),"\n",(0,s.jsx)(n.li,{children:"Execution creation rate"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,s.jsx)(n.h3,{id:"unit-tests",children:"Unit Tests"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Test\nvoid testWebhookSignatureValidation() {\n    String payload = "{\\"test\\": \\"data\\"}";\n    String secret = "test-secret";\n    String signature = generateHmacSha256(payload, secret);\n    \n    boolean valid = signatureValidator.validateGitHubSignature(\n        "sha256=" + signature,\n        payload,\n        secret\n    );\n    \n    assertTrue(valid);\n}\n\n@Test\nvoid testWebhookDeduplication() {\n    String eventId = "test-event-123";\n    String service = "github";\n    \n    // First call should not be duplicate\n    assertFalse(deduplicationService.checkAndMark(eventId, service));\n    \n    // Second call should be duplicate\n    assertTrue(deduplicationService.checkAndMark(eventId, service));\n}\n\n@Test\nvoid testPayloadMapping() {\n    Map<String, Object> githubPayload = Map.of(\n        "issue", Map.of(\n            "number", 42,\n            "title", "Test Issue"\n        )\n    );\n    \n    Map<String, Object> mapped = payloadMappingService\n        .mapWebhookPayload("github", "new_issue", githubPayload);\n    \n    assertEquals(42, mapped.get("issue_number"));\n    assertEquals("Test Issue", mapped.get("title"));\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"integration-tests",children:"Integration Tests"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@SpringBootTest\n@AutoConfigureMockMvc\nclass WebhookControllerIntegrationTest {\n    \n    @Autowired\n    private MockMvc mockMvc;\n    \n    @Test\n    void testGitHubWebhook() throws Exception {\n        String payload = loadResource("github-issue-webhook.json");\n        String signature = generateSignature(payload);\n        \n        mockMvc.perform(post("/api/hooks/github/issues")\n                .header("X-GitHub-Event", "issues")\n                .header("X-Hub-Signature-256", signature)\n                .header("X-GitHub-Delivery", "test-123")\n                .contentType(MediaType.APPLICATION_JSON)\n                .content(payload))\n            .andExpect(status().isOk())\n            .andExpect(jsonPath("$.status").value("processed"))\n            .andExpect(jsonPath("$.executionCount").exists());\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"mock-webhook-testing",children:"Mock Webhook Testing"}),"\n",(0,s.jsx)(n.p,{children:"Tool for testing webhook endpoints locally:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Install webhook testing tool\nnpm install -g @webhooksite/cli\n\n# Test GitHub webhook\ncurl -X POST http://localhost:8080/api/hooks/github/issues \\\n  -H "Content-Type: application/json" \\\n  -H "X-GitHub-Event: issues" \\\n  -H "X-Hub-Signature-256: sha256=$(echo -n \'{...}\' | openssl dgst -sha256 -hmac \'secret\')" \\\n  -H "X-GitHub-Delivery: test-123" \\\n  -d @test-payloads/github-issue.json\n'})}),"\n",(0,s.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.github.com/en/developers/webhooks-and-events/webhooks",children:"GitHub Webhooks Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://api.slack.com/apis/connections/events-api",children:"Slack Events API"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://discord.com/developers/docs/resources/webhook",children:"Discord Webhooks"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/HMAC",children:"HMAC Signature Validation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://ed25519.cr.yp.to/",children:"Ed25519 Signatures"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);