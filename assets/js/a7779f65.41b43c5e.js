"use strict";(globalThis.webpackChunkdocusaurus=globalThis.webpackChunkdocusaurus||[]).push([[7811],{8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>t});var i=s(6540);const r={},l=i.createContext(r);function c(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(l.Provider,{value:n},e.children)}},8868:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"providers/slack","title":"Slack Provider - Technical Documentation","description":"Overview","source":"@site/docs/providers/slack.md","sourceDirName":"providers","slug":"/providers/slack","permalink":"/AREA_Back/docs/providers/slack","draft":false,"unlisted":false,"editUrl":"https://github.com/SamTess/AREA_Back/tree/main/docusaurus/docs/providers/slack.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Google Provider - Technical Documentation","permalink":"/AREA_Back/docs/providers/google"},"next":{"title":"API Reference","permalink":"/AREA_Back/docs/api-reference"}}');var r=s(4848),l=s(8453);const c={},t="Slack Provider - Technical Documentation",a={},d=[{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Core Components",id:"core-components",level:3},{value:"1. OAuth Service (<code>OAuthSlackService.java</code>)",id:"1-oauth-service-oauthslackservicejava",level:4},{value:"2. Action Service (<code>SlackActionService.java</code>)",id:"2-action-service-slackactionservicejava",level:4},{value:"3. Webhook Service (<code>SlackWebhookService.java</code>)",id:"3-webhook-service-slackwebhookservicejava",level:4},{value:"OAuth2 Implementation",id:"oauth2-implementation",level:2},{value:"Configuration",id:"configuration",level:3},{value:"OAuth Flow",id:"oauth-flow",level:3},{value:"Required Scopes",id:"required-scopes",level:3},{value:"Account Linking",id:"account-linking",level:3},{value:"Implemented Services",id:"implemented-services",level:2},{value:"Actions (Executable Operations)",id:"actions-executable-operations",level:3},{value:"1. Send Message",id:"1-send-message",level:4},{value:"2. Create Channel",id:"2-create-channel",level:4},{value:"3. Invite User to Channel",id:"3-invite-user-to-channel",level:4},{value:"4. Add Reaction",id:"4-add-reaction",level:4},{value:"5. Pin Message",id:"5-pin-message",level:4},{value:"6. Upload File",id:"6-upload-file",level:4},{value:"7. Archive Channel",id:"7-archive-channel",level:4},{value:"Events (Triggers)",id:"events-triggers",level:3},{value:"1. New Message",id:"1-new-message",level:4},{value:"2. Message Deleted",id:"2-message-deleted",level:4},{value:"3. Reaction Added",id:"3-reaction-added",level:4},{value:"4. Channel Created",id:"4-channel-created",level:4},{value:"5. User Joined Channel",id:"5-user-joined-channel",level:4},{value:"6. File Shared",id:"6-file-shared",level:4},{value:"API Integration",id:"api-integration",level:2},{value:"Base URL",id:"base-url",level:3},{value:"Authentication",id:"authentication",level:3},{value:"Response Format",id:"response-format",level:3},{value:"Rate Limiting",id:"rate-limiting",level:3},{value:"Key Endpoints Used",id:"key-endpoints-used",level:3},{value:"Webhook System",id:"webhook-system",level:2},{value:"Webhook Registration",id:"webhook-registration",level:3},{value:"URL Verification",id:"url-verification",level:3},{value:"Webhook Signature Validation",id:"webhook-signature-validation",level:3},{value:"Webhook Event Processing",id:"webhook-event-processing",level:3},{value:"Deduplication",id:"deduplication",level:3},{value:"Token Management",id:"token-management",level:2},{value:"Storage",id:"storage",level:3},{value:"Retrieval",id:"retrieval",level:3},{value:"Token Refresh",id:"token-refresh",level:3},{value:"Monitoring &amp; Metrics",id:"monitoring--metrics",level:2},{value:"Prometheus Metrics",id:"prometheus-metrics",level:3},{value:"Exposed Metrics",id:"exposed-metrics",level:3},{value:"Database Schema",id:"database-schema",level:2},{value:"Service Entry",id:"service-entry",level:3},{value:"Action Definitions",id:"action-definitions",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Common Errors",id:"common-errors",level:3},{value:"Error Response Format",id:"error-response-format",level:3},{value:"Implementation",id:"implementation",level:3},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Token Security",id:"token-security",level:3},{value:"Webhook Security",id:"webhook-security",level:3},{value:"Permission Management",id:"permission-management",level:3},{value:"Integration Examples",id:"integration-examples",level:2},{value:"Frontend OAuth Initiation",id:"frontend-oauth-initiation",level:3},{value:"Backend AREA Creation",id:"backend-area-creation",level:3},{value:"Testing",id:"testing",level:2},{value:"Unit Tests Location",id:"unit-tests-location",level:3},{value:"Test Coverage",id:"test-coverage",level:3},{value:"Mock Data",id:"mock-data",level:3},{value:"Future Enhancements",id:"future-enhancements",level:2},{value:"Planned Features",id:"planned-features",level:3},{value:"Resources",id:"resources",level:2},{value:"Support",id:"support",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"slack-provider---technical-documentation",children:"Slack Provider - Technical Documentation"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"The Slack provider enables OAuth2 authentication and integration with Slack workspaces within the AREA platform. It allows users to authenticate using their Slack account and interact with channels, messages, and workspace members through automated actions and event triggers."}),"\n",(0,r.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,r.jsx)(n.h3,{id:"core-components",children:"Core Components"}),"\n",(0,r.jsxs)(n.h4,{id:"1-oauth-service-oauthslackservicejava",children:["1. OAuth Service (",(0,r.jsx)(n.code,{children:"OAuthSlackService.java"}),")"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Location"}),": ",(0,r.jsx)(n.code,{children:"src/main/java/area/server/AREA_Back/service/Auth/OAuthSlackService.java"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Extends"}),": ",(0,r.jsx)(n.code,{children:"OAuthService"})," (abstract base class)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Handles Slack OAuth2 authentication and token management"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Key Features"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"OAuth2 authorization code flow"}),"\n",(0,r.jsx)(n.li,{children:"User authentication and registration"}),"\n",(0,r.jsx)(n.li,{children:"Account linking to existing users"}),"\n",(0,r.jsx)(n.li,{children:"Access token encryption and storage"}),"\n",(0,r.jsx)(n.li,{children:"Workspace information retrieval"}),"\n",(0,r.jsx)(n.li,{children:"Prometheus metrics integration"}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"2-action-service-slackactionservicejava",children:["2. Action Service (",(0,r.jsx)(n.code,{children:"SlackActionService.java"}),")"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Location"}),": ",(0,r.jsx)(n.code,{children:"src/main/java/area/server/AREA_Back/service/Area/Services/SlackActionService.java"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Executes Slack actions (send messages, manage channels, etc.)"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"3-webhook-service-slackwebhookservicejava",children:["3. Webhook Service (",(0,r.jsx)(n.code,{children:"SlackWebhookService.java"}),")"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Location"}),": ",(0,r.jsx)(n.code,{children:"src/main/java/area/server/AREA_Back/service/Webhook/SlackWebhookService.java"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Processes incoming Slack webhook events"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"oauth2-implementation",children:"OAuth2 Implementation"}),"\n",(0,r.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.p,{children:"The Slack provider requires the following environment variables:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"spring.security.oauth2.client.registration.slack.client-id=<your-client-id>\nspring.security.oauth2.client.registration.slack.client-secret=<your-client-secret>\napp.webhook.slack.secret=<your-signing-secret>\nOAUTH_REDIRECT_BASE_URL=http://localhost:3000\n"})}),"\n",(0,r.jsx)(n.h3,{id:"oauth-flow",children:"OAuth Flow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Authorization Request"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["User initiates OAuth flow via ",(0,r.jsx)(n.code,{children:"/api/oauth/slack/authorize"})]}),"\n",(0,r.jsx)(n.li,{children:"Redirects to Slack with required scopes"}),"\n",(0,r.jsxs)(n.li,{children:["Callback URL: ",(0,r.jsx)(n.code,{children:"{OAUTH_REDIRECT_BASE_URL}/oauth-callback"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Token Exchange"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Authorization code is exchanged for access token"}),"\n",(0,r.jsxs)(n.li,{children:["Token endpoint: ",(0,r.jsx)(n.code,{children:"https://slack.com/api/oauth.v2.access"})]}),"\n",(0,r.jsx)(n.li,{children:"Access token is encrypted before storage"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User Profile Retrieval"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Fetches user identity from ",(0,r.jsx)(n.code,{children:"https://slack.com/api/users.identity"})]}),"\n",(0,r.jsx)(n.li,{children:"Retrieves workspace information"}),"\n",(0,r.jsx)(n.li,{children:"Creates or updates user account"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Session Creation"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Generates JWT access and refresh tokens"}),"\n",(0,r.jsx)(n.li,{children:"Sets secure HTTP-only cookies"}),"\n",(0,r.jsx)(n.li,{children:"Stores encrypted Slack access token in database"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"required-scopes",children:"Required Scopes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"channels:read       - View basic channel information\nchannels:write      - Manage public channels\nchat:write          - Send messages\nusers:read          - View users in workspace\nusers:read.email    - View user email addresses\nreactions:read      - View reactions on messages\nreactions:write     - Add reactions to messages\nfiles:read          - View files shared in channels\nfiles:write         - Upload and share files\n"})}),"\n",(0,r.jsx)(n.h3,{id:"account-linking",children:"Account Linking"}),"\n",(0,r.jsx)(n.p,{children:"The provider supports linking Slack accounts to existing authenticated users:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public UserOAuthIdentity linkToExistingUser(User existingUser, String authorizationCode)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint"}),": ",(0,r.jsx)(n.code,{children:"/api/oauth-link/slack/exchange"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Features"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Links Slack account to current session user"}),"\n",(0,r.jsx)(n.li,{children:"Validates email uniqueness"}),"\n",(0,r.jsx)(n.li,{children:"Prevents duplicate linking"}),"\n",(0,r.jsx)(n.li,{children:"Stores Slack profile metadata (user_id, team_id, workspace_name)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"implemented-services",children:"Implemented Services"}),"\n",(0,r.jsx)(n.h3,{id:"actions-executable-operations",children:"Actions (Executable Operations)"}),"\n",(0,r.jsx)(n.h4,{id:"1-send-message",children:"1. Send Message"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action Key"}),": ",(0,r.jsx)(n.code,{children:"send_message"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Sends a message to a Slack channel"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"channel"})," (required): Channel ID or name"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"text"})," (required): Message text"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"blocks"})," (optional): Rich message blocks"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"thread_ts"})," (optional): Thread timestamp for replies"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "channel": "C1234567890",\n  "text": "Hello from AREA!",\n  "blocks": [\n    {\n      "type": "section",\n      "text": {\n        "type": "mrkdwn",\n        "text": "*Notification*\\nYour automation was triggered"\n      }\n    }\n  ]\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Endpoint"}),": ",(0,r.jsx)(n.code,{children:"POST https://slack.com/api/chat.postMessage"})]}),"\n",(0,r.jsx)(n.h4,{id:"2-create-channel",children:"2. Create Channel"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action Key"}),": ",(0,r.jsx)(n.code,{children:"create_channel"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Creates a new public or private channel"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"name"})," (required): Channel name (lowercase, no spaces)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"is_private"})," (optional): Create private channel (default: false)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"team_id"})," (optional): Workspace ID"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Endpoint"}),": ",(0,r.jsx)(n.code,{children:"POST https://slack.com/api/conversations.create"})]}),"\n",(0,r.jsx)(n.h4,{id:"3-invite-user-to-channel",children:"3. Invite User to Channel"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action Key"}),": ",(0,r.jsx)(n.code,{children:"invite_user"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Invites user to a channel"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"channel"})," (required): Channel ID"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"users"})," (required): Comma-separated user IDs"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Endpoint"}),": ",(0,r.jsx)(n.code,{children:"POST https://slack.com/api/conversations.invite"})]}),"\n",(0,r.jsx)(n.h4,{id:"4-add-reaction",children:"4. Add Reaction"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action Key"}),": ",(0,r.jsx)(n.code,{children:"add_reaction"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Adds a reaction emoji to a message"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"channel"})," (required): Channel ID"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"timestamp"})," (required): Message timestamp"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"name"})," (required): Emoji name (without colons)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "channel": "C1234567890",\n  "timestamp": "1234567890.123456",\n  "name": "thumbsup"\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Endpoint"}),": ",(0,r.jsx)(n.code,{children:"POST https://slack.com/api/reactions.add"})]}),"\n",(0,r.jsx)(n.h4,{id:"5-pin-message",children:"5. Pin Message"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action Key"}),": ",(0,r.jsx)(n.code,{children:"pin_message"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Pins a message to a channel"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"channel"})," (required): Channel ID"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"timestamp"})," (required): Message timestamp"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Endpoint"}),": ",(0,r.jsx)(n.code,{children:"POST https://slack.com/api/pins.add"})]}),"\n",(0,r.jsx)(n.h4,{id:"6-upload-file",children:"6. Upload File"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action Key"}),": ",(0,r.jsx)(n.code,{children:"upload_file"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Uploads a file to Slack"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"channels"})," (required): Comma-separated channel IDs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"content"})," (optional): File content"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"file"})," (optional): File URL or path"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"title"})," (optional): File title"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"initial_comment"})," (optional): Initial comment"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Endpoint"}),": ",(0,r.jsx)(n.code,{children:"POST https://slack.com/api/files.upload"})]}),"\n",(0,r.jsx)(n.h4,{id:"7-archive-channel",children:"7. Archive Channel"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action Key"}),": ",(0,r.jsx)(n.code,{children:"archive_channel"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Archives a channel"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"channel"})," (required): Channel ID"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Endpoint"}),": ",(0,r.jsx)(n.code,{children:"POST https://slack.com/api/conversations.archive"})]}),"\n",(0,r.jsx)(n.h3,{id:"events-triggers",children:"Events (Triggers)"}),"\n",(0,r.jsx)(n.h4,{id:"1-new-message",children:"1. New Message"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Event Key"}),": ",(0,r.jsx)(n.code,{children:"message.channels"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Triggers when a message is posted in a channel"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Webhook Event"}),": ",(0,r.jsx)(n.code,{children:"message"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"channel_id"})," (optional): Filter by specific channel"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"user_id"})," (optional): Filter by specific user"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"text_contains"})," (optional): Filter by message content"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Payload"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "type": "message",\n  "channel": "C1234567890",\n  "user": "U1234567890",\n  "text": "Hello, world!",\n  "ts": "1234567890.123456",\n  "thread_ts": "1234567890.123456",\n  "channel_type": "channel"\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"2-message-deleted",children:"2. Message Deleted"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Event Key"}),": ",(0,r.jsx)(n.code,{children:"message_deleted"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Triggers when a message is deleted"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Webhook Event"}),": ",(0,r.jsx)(n.code,{children:"message_deleted"})]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"3-reaction-added",children:"3. Reaction Added"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Event Key"}),": ",(0,r.jsx)(n.code,{children:"reaction_added"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Triggers when a reaction is added to a message"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Webhook Event"}),": ",(0,r.jsx)(n.code,{children:"reaction_added"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"emoji"})," (optional): Filter by specific emoji"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Payload"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "type": "reaction_added",\n  "user": "U1234567890",\n  "reaction": "thumbsup",\n  "item": {\n    "type": "message",\n    "channel": "C1234567890",\n    "ts": "1234567890.123456"\n  },\n  "event_ts": "1234567890.123456"\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"4-channel-created",children:"4. Channel Created"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Event Key"}),": ",(0,r.jsx)(n.code,{children:"channel_created"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Triggers when a channel is created"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Webhook Event"}),": ",(0,r.jsx)(n.code,{children:"channel_created"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Payload"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "type": "channel_created",\n  "channel": {\n    "id": "C1234567890",\n    "name": "new-channel",\n    "created": 1234567890,\n    "creator": "U1234567890"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"5-user-joined-channel",children:"5. User Joined Channel"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Event Key"}),": ",(0,r.jsx)(n.code,{children:"member_joined_channel"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Triggers when a user joins a channel"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Webhook Event"}),": ",(0,r.jsx)(n.code,{children:"member_joined_channel"})]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"6-file-shared",children:"6. File Shared"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Event Key"}),": ",(0,r.jsx)(n.code,{children:"file_shared"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Triggers when a file is shared"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Webhook Event"}),": ",(0,r.jsx)(n.code,{children:"file_shared"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"api-integration",children:"API Integration"}),"\n",(0,r.jsx)(n.h3,{id:"base-url",children:"Base URL"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"https://slack.com/api\n"})}),"\n",(0,r.jsx)(n.h3,{id:"authentication",children:"Authentication"}),"\n",(0,r.jsx)(n.p,{children:"All API requests require authentication via Bearer token:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Authorization: Bearer <access_token>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"response-format",children:"Response Format"}),"\n",(0,r.jsx)(n.p,{children:"Slack API responses follow a consistent format:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "ok": true,\n  "channel": "C1234567890",\n  "ts": "1234567890.123456",\n  "message": {\n    "text": "Message content"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Error response:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "ok": false,\n  "error": "channel_not_found"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,r.jsx)(n.p,{children:"Slack implements rate limiting:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tier 1"}),": 1 request per minute (e.g., ",(0,r.jsx)(n.code,{children:"users.list"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tier 2"}),": 20 requests per minute (e.g., ",(0,r.jsx)(n.code,{children:"chat.postMessage"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tier 3"}),": 50 requests per minute (e.g., ",(0,r.jsx)(n.code,{children:"conversations.history"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tier 4"}),": 100+ requests per minute (e.g., ",(0,r.jsx)(n.code,{children:"conversations.list"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Response Headers"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Retry-After"}),": Seconds to wait before retry"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Handling"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'if (response.getStatusCode() == 429) {\n    int retryAfter = Integer.parseInt(\n        response.getHeaders().getFirst("Retry-After")\n    );\n    Thread.sleep(retryAfter * 1000);\n    // Retry request\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"key-endpoints-used",children:"Key Endpoints Used"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Endpoint"}),(0,r.jsx)(n.th,{children:"Method"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/oauth.v2.access"})}),(0,r.jsx)(n.td,{children:"POST"}),(0,r.jsx)(n.td,{children:"Exchange authorization code"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/users.identity"})}),(0,r.jsx)(n.td,{children:"GET"}),(0,r.jsx)(n.td,{children:"Get current user identity"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/chat.postMessage"})}),(0,r.jsx)(n.td,{children:"POST"}),(0,r.jsx)(n.td,{children:"Send message"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/conversations.create"})}),(0,r.jsx)(n.td,{children:"POST"}),(0,r.jsx)(n.td,{children:"Create channel"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/conversations.invite"})}),(0,r.jsx)(n.td,{children:"POST"}),(0,r.jsx)(n.td,{children:"Invite user to channel"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/reactions.add"})}),(0,r.jsx)(n.td,{children:"POST"}),(0,r.jsx)(n.td,{children:"Add reaction"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/files.upload"})}),(0,r.jsx)(n.td,{children:"POST"}),(0,r.jsx)(n.td,{children:"Upload file"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"webhook-system",children:"Webhook System"}),"\n",(0,r.jsx)(n.h3,{id:"webhook-registration",children:"Webhook Registration"}),"\n",(0,r.jsx)(n.p,{children:"To receive Slack events, set up Event Subscriptions in your Slack app:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Go to Slack API Dashboard"}),"\n",(0,r.jsx)(n.li,{children:"Select your app"}),"\n",(0,r.jsx)(n.li,{children:"Navigate to Event Subscriptions"}),"\n",(0,r.jsx)(n.li,{children:"Enable Events"}),"\n",(0,r.jsxs)(n.li,{children:["Add Request URL: ",(0,r.jsx)(n.code,{children:"https://your-domain.com/api/webhooks/slack"})]}),"\n",(0,r.jsx)(n.li,{children:"Subscribe to bot events"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"url-verification",children:"URL Verification"}),"\n",(0,r.jsx)(n.p,{children:"Slack sends a challenge request to verify the webhook URL:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@PostMapping("/api/webhooks/slack")\npublic ResponseEntity<?> handleWebhook(@RequestBody Map<String, Object> payload) {\n    // Handle URL verification\n    if ("url_verification".equals(payload.get("type"))) {\n        return ResponseEntity.ok(Map.of(\n            "challenge", payload.get("challenge")\n        ));\n    }\n    \n    // Process event\n    processEvent(payload);\n    return ResponseEntity.ok().build();\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"webhook-signature-validation",children:"Webhook Signature Validation"}),"\n",(0,r.jsx)(n.p,{children:"Slack signs webhooks using HMAC-SHA256:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public boolean validateSignature(String signature, String timestamp, \n                                 String body, String signingSecret) {\n    // Check timestamp freshness (max 5 minutes)\n    long requestTime = Long.parseLong(timestamp);\n    long currentTime = System.currentTimeMillis() / 1000;\n    if (Math.abs(currentTime - requestTime) > 300) {\n        return false;\n    }\n    \n    // Compute signature\n    String baseString = "v0:" + timestamp + ":" + body;\n    Mac hmac = Mac.getInstance("HmacSHA256");\n    SecretKeySpec secretKey = new SecretKeySpec(\n        signingSecret.getBytes(), \n        "HmacSHA256"\n    );\n    hmac.init(secretKey);\n    byte[] hash = hmac.doFinal(baseString.getBytes());\n    String computed = "v0=" + Hex.encodeHexString(hash);\n    \n    return MessageDigest.isEqual(\n        signature.getBytes(),\n        computed.getBytes()\n    );\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Headers"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"X-Slack-Request-Timestamp"}),": Request timestamp"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"X-Slack-Signature"}),": Request signature (v0=...)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"webhook-event-processing",children:"Webhook Event Processing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@PostMapping("/api/webhooks/slack")\npublic ResponseEntity<?> handleWebhook(\n    @RequestHeader("X-Slack-Request-Timestamp") String timestamp,\n    @RequestHeader("X-Slack-Signature") String signature,\n    @RequestBody String body\n) {\n    // Validate signature\n    if (!webhookSignatureValidator.validate("slack", signature, timestamp, body)) {\n        return ResponseEntity.status(401).build();\n    }\n    \n    Map<String, Object> payload = objectMapper.readValue(body, Map.class);\n    \n    // Handle URL verification\n    if ("url_verification".equals(payload.get("type"))) {\n        return ResponseEntity.ok(Map.of("challenge", payload.get("challenge")));\n    }\n    \n    // Handle event callback\n    if ("event_callback".equals(payload.get("type"))) {\n        Map<String, Object> event = (Map<String, Object>) payload.get("event");\n        webhookEventProcessingService.processWebhook("slack", event);\n    }\n    \n    return ResponseEntity.ok().build();\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"deduplication",children:"Deduplication"}),"\n",(0,r.jsx)(n.p,{children:"Slack webhooks are deduplicated using event IDs:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'String eventId = payload.get("event_id").toString();\nif (webhookDeduplicationService.isDuplicate("slack", eventId)) {\n    return; // Skip duplicate event\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"token-management",children:"Token Management"}),"\n",(0,r.jsx)(n.h3,{id:"storage",children:"Storage"}),"\n",(0,r.jsx)(n.p,{children:"Slack OAuth tokens are stored encrypted in the database:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Entity\n@Table(name = "a_user_oauth_identities", schema = "area")\npublic class UserOAuthIdentity {\n    private String provider = "slack";\n    private String accessTokenEnc;    // Encrypted access token\n    private LocalDateTime expiresAt;  // Token expiration (Slack tokens don\'t expire by default)\n    private Map<String, Object> scopes; // OAuth scopes\n    private Map<String, Object> tokenMeta; // Slack workspace metadata\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"retrieval",children:"Retrieval"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public String getAccessToken(UUID userId) {\n    ServiceAccount account = serviceAccountRepository\n        .findByUserIdAndServiceKey(userId, "slack")\n        .orElseThrow(() -> new RuntimeException("Slack not connected"));\n    \n    return tokenEncryptionService.decrypt(account.getAccessTokenEnc());\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"token-refresh",children:"Token Refresh"}),"\n",(0,r.jsx)(n.p,{children:"Slack bot tokens do not expire by default, but user tokens may need refresh:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public String refreshToken(UUID userId) {\n    // Slack user tokens rarely expire\n    // If needed, re-authenticate user via OAuth flow\n    throw new UnsupportedOperationException(\n        "Slack tokens do not support refresh. Re-authenticate user."\n    );\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"monitoring--metrics",children:"Monitoring & Metrics"}),"\n",(0,r.jsx)(n.h3,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@PostConstruct\nprivate void initMetrics() {\n    oauthLoginSuccessCounter = Counter.builder("slack_oauth_login_success")\n        .description("Slack OAuth login successes")\n        .register(meterRegistry);\n    \n    oauthLoginFailureCounter = Counter.builder("slack_oauth_login_failure")\n        .description("Slack OAuth login failures")\n        .register(meterRegistry);\n    \n    apiCallCounter = Counter.builder("slack_api_calls")\n        .tag("endpoint", "various")\n        .description("Slack API calls")\n        .register(meterRegistry);\n    \n    webhookEventCounter = Counter.builder("slack_webhook_events")\n        .tag("event_type", "various")\n        .description("Slack webhook events received")\n        .register(meterRegistry);\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"exposed-metrics",children:"Exposed Metrics"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"slack_oauth_login_success_total"}),": Successful OAuth logins"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"slack_oauth_login_failure_total"}),": Failed OAuth logins"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"slack_api_calls_total"}),": Total API calls made"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"slack_webhook_events_total"}),": Webhook events received"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"slack_rate_limit_hits_total"}),": Rate limit encounters"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"database-schema",children:"Database Schema"}),"\n",(0,r.jsx)(n.h3,{id:"service-entry",children:"Service Entry"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INSERT INTO area.a_services (key, name, auth, is_active, docs_url, icon_light_url, icon_dark_url) \nVALUES (\n    'slack',\n    'Slack',\n    'OAUTH2',\n    true,\n    'https://api.slack.com/docs',\n    'https://cdn.simpleicons.org/slack/4A154B',\n    'https://cdn.simpleicons.org/slack/FFFFFF'\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"action-definitions",children:"Action Definitions"}),"\n",(0,r.jsx)(n.p,{children:"Action definitions for Slack are stored in the migration file:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Location: ",(0,r.jsx)(n.code,{children:"src/main/resources/db/migration/V13__Add_slack_service_and_actions.sql"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.h3,{id:"common-errors",children:"Common Errors"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Error Code"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Handling"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"invalid_auth"}),(0,r.jsx)(n.td,{children:"Invalid token"}),(0,r.jsx)(n.td,{children:"Re-authenticate user"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"channel_not_found"}),(0,r.jsx)(n.td,{children:"Channel doesn't exist"}),(0,r.jsx)(n.td,{children:"Verify channel ID"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"cant_invite_self"}),(0,r.jsx)(n.td,{children:"Can't invite self"}),(0,r.jsx)(n.td,{children:"Check user ID"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"not_in_channel"}),(0,r.jsx)(n.td,{children:"Bot not in channel"}),(0,r.jsx)(n.td,{children:"Invite bot first"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"rate_limited"}),(0,r.jsx)(n.td,{children:"Rate limit exceeded"}),(0,r.jsx)(n.td,{children:"Implement backoff"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"missing_scope"}),(0,r.jsx)(n.td,{children:"Missing permission"}),(0,r.jsx)(n.td,{children:"Request additional scopes"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"error-response-format",children:"Error Response Format"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "ok": false,\n  "error": "channel_not_found"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"implementation",children:"Implementation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public Map<String, Object> executeAction(String actionKey, \n                                         Map<String, Object> inputPayload,\n                                         Map<String, Object> actionParams,\n                                         UUID userId) {\n    try {\n        String accessToken = getAccessToken(userId);\n        \n        return switch (actionKey) {\n            case "send_message" -> sendMessage(accessToken, actionParams);\n            case "create_channel" -> createChannel(accessToken, actionParams);\n            default -> throw new IllegalArgumentException("Unknown action: " + actionKey);\n        };\n    } catch (HttpClientErrorException e) {\n        Map<String, Object> errorResponse = objectMapper.readValue(\n            e.getResponseBodyAsString(),\n            Map.class\n        );\n        \n        String error = (String) errorResponse.get("error");\n        \n        if ("invalid_auth".equals(error)) {\n            throw new RuntimeException("Slack token expired. Please re-authenticate.");\n        }\n        \n        throw new RuntimeException("Slack API error: " + error);\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,r.jsx)(n.h3,{id:"token-security",children:"Token Security"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Encryption"}),": All tokens encrypted at rest using AES-256"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Transmission"}),": Tokens only transmitted over HTTPS"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scope Limitation"}),": Request minimum required scopes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Token Storage"}),": Store in secure database with encryption"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"webhook-security",children:"Webhook Security"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Signature Validation"}),": Always validate HMAC-SHA256 signatures"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Timestamp Check"}),": Reject requests older than 5 minutes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Secret Management"}),": Store signing secret in environment variables"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"HTTPS Only"}),": Only accept webhook requests over HTTPS"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"permission-management",children:"Permission Management"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// Check bot permissions before action execution\npublic boolean hasPermission(String channel, String permission) {\n    // Fetch bot member in channel\n    // Check permission scopes\n    return true; // or false\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"integration-examples",children:"Integration Examples"}),"\n",(0,r.jsx)(n.h3,{id:"frontend-oauth-initiation",children:"Frontend OAuth Initiation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"export const connectSlack = (): void => {\n  localStorage.setItem('oauth_provider', 'slack');\n  const oauthUrl = `${API_CONFIG.baseURL}/api/oauth/slack/authorize`;\n  window.location.href = oauthUrl;\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"backend-area-creation",children:"Backend AREA Creation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'CreateAreaWithActionsRequest request = new CreateAreaWithActionsRequest();\nrequest.setName("Slack Notification");\nrequest.setDescription("Send Slack message when GitHub issue created");\n\n// Action (trigger)\nActionLinkRequest action = new ActionLinkRequest();\naction.setActionDefinitionKey("github.new_issue");\naction.setServiceAccountId(githubAccountId);\naction.setActionParams(Map.of("repository", "owner/repo"));\n\n// Reaction\nActionLinkRequest reaction = new ActionLinkRequest();\nreaction.setActionDefinitionKey("slack.send_message");\nreaction.setServiceAccountId(slackAccountId);\nreaction.setActionParams(Map.of(\n    "channel", "C1234567890",\n    "text", "New issue: {{issue_title}}"\n));\n\nrequest.setActions(List.of(action));\nrequest.setReactions(List.of(reaction));\n'})}),"\n",(0,r.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,r.jsx)(n.h3,{id:"unit-tests-location",children:"Unit Tests Location"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"src/test/java/area/server/AREA_Back/service/OAuthSlackServiceTest.java"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"src/test/java/area/server/AREA_Back/service/SlackActionServiceTest.java"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"src/test/java/area/server/AREA_Back/service/SlackWebhookServiceTest.java"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"test-coverage",children:"Test Coverage"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Invalid action keys"}),"\n",(0,r.jsx)(n.li,{children:"Missing tokens"}),"\n",(0,r.jsx)(n.li,{children:"Token validation"}),"\n",(0,r.jsx)(n.li,{children:"Webhook signature validation"}),"\n",(0,r.jsx)(n.li,{children:"Event deduplication"}),"\n",(0,r.jsx)(n.li,{children:"Error handling scenarios"}),"\n",(0,r.jsx)(n.li,{children:"Rate limiting scenarios"}),"\n",(0,r.jsx)(n.li,{children:"Permission validation"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"mock-data",children:"Mock Data"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Test\nvoid testSendMessage() {\n    // Mock Slack API response\n    when(restTemplate.postForEntity(anyString(), any(), eq(Map.class)))\n        .thenReturn(ResponseEntity.ok(Map.of(\n            "ok", true,\n            "channel", "C1234567890",\n            "ts", "1234567890.123456"\n        )));\n    \n    Map<String, Object> result = slackActionService.executeAction(\n        "send_message",\n        Map.of(),\n        Map.of("channel", "C123", "text", "Test"),\n        userId\n    );\n    \n    assertNotNull(result);\n    assertTrue((Boolean) result.get("ok"));\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,r.jsx)(n.h3,{id:"planned-features",children:"Planned Features"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Slack Connect"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cross-workspace channels"}),"\n",(0,r.jsx)(n.li,{children:"External collaboration"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Workflow Builder Integration"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Custom workflow steps"}),"\n",(0,r.jsx)(n.li,{children:"Workflow triggers"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Modal/Block Kit"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Interactive modals"}),"\n",(0,r.jsx)(n.li,{children:"Rich UI components"}),"\n",(0,r.jsx)(n.li,{children:"Form submissions"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Slash Commands"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Register custom commands"}),"\n",(0,r.jsx)(n.li,{children:"Handle command interactions"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"App Home"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Customize app home tab"}),"\n",(0,r.jsx)(n.li,{children:"User-specific content"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Scheduled Messages"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Schedule message delivery"}),"\n",(0,r.jsx)(n.li,{children:"Recurring messages"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Thread Management"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reply to threads"}),"\n",(0,r.jsx)(n.li,{children:"Thread subscriptions"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Slack API Documentation"}),": ",(0,r.jsx)(n.a,{href:"https://api.slack.com/docs",children:"https://api.slack.com/docs"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"OAuth2 Guide"}),": ",(0,r.jsx)(n.a,{href:"https://api.slack.com/authentication/oauth-v2",children:"https://api.slack.com/authentication/oauth-v2"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Event Subscriptions"}),": ",(0,r.jsx)(n.a,{href:"https://api.slack.com/events-api",children:"https://api.slack.com/events-api"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Block Kit Builder"}),": ",(0,r.jsx)(n.a,{href:"https://app.slack.com/block-kit-builder",children:"https://app.slack.com/block-kit-builder"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rate Limiting"}),": ",(0,r.jsx)(n.a,{href:"https://api.slack.com/docs/rate-limits",children:"https://api.slack.com/docs/rate-limits"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Webhook Signing"}),": ",(0,r.jsx)(n.a,{href:"https://api.slack.com/authentication/verifying-requests-from-slack",children:"https://api.slack.com/authentication/verifying-requests-from-slack"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"support",children:"Support"}),"\n",(0,r.jsx)(n.p,{children:"For issues related to Slack integration:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Check Slack API status: ",(0,r.jsx)(n.a,{href:"https://status.slack.com",children:"https://status.slack.com"})]}),"\n",(0,r.jsx)(n.li,{children:"Review API documentation"}),"\n",(0,r.jsx)(n.li,{children:"Check AREA backend logs"}),"\n",(0,r.jsx)(n.li,{children:"Verify OAuth credentials"}),"\n",(0,r.jsx)(n.li,{children:"Test webhook connectivity"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);